<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ±">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<title>Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ± 2026</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#062115">
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&family=Reem+Kufi:wght@400;700&display=swap" rel="stylesheet">
<style>
:root{--primary:#062115;--secondary:#0b2b1d;--accent:#d4af37;--bg:#fdfcf6;--text:#062115;--card:#ffffff;--ease:all .45s cubic-bezier(.175,.885,.32,1.275)}
.dark-mode{--primary:#020a06;--secondary:#04140e;--bg:#020a06;--text:#f1f1f1;--card:#0b2b1d}
*{-webkit-tap-highlight-color:transparent;user-select:none;box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{background:var(--bg);color:var(--text);font-family:'Amiri',serif;transition:background .5s;overflow-x:hidden;background-image:url('https://www.transparenttextures.com/patterns/islamic-art.png')}

/* splash */
#splash{position:fixed;inset:0;background:var(--primary);z-index:10000;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 1s}
.splash-logo{font-family:'Reem Kufi';font-size:4em;color:var(--accent);animation:pulse 2s infinite;text-shadow:0 0 20px rgba(212,175,55,.5)}
@keyframes pulse{0%,100%{transform:scale(1);opacity:.8}50%{transform:scale(1.1);opacity:1}}

/* toast */
#toast{position:fixed;top:20px;left:50%;transform:translateX(-50%) translateY(-300%);background:var(--primary);color:var(--accent);padding:13px 34px;border-radius:50px;border:2px solid var(--accent);z-index:9999;transition:var(--ease);font-weight:bold;box-shadow:0 10px 28px rgba(0,0,0,.5);text-align:center;pointer-events:none;max-width:90vw}
#toast.show{transform:translateX(-50%) translateY(0)}

/* home */
#home-screen{display:flex;flex-direction:column;min-height:100vh}
header{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:55px 20px 70px;text-align:center;border-bottom:5px solid var(--accent);position:relative}
header h1{font-family:'Reem Kufi';font-size:3.2em;color:var(--accent)}
header p{color:rgba(255,255,255,.65);margin-top:6px;font-size:1em}
#menu-btn{position:absolute;top:16px;left:16px;width:46px;height:46px;border-radius:50%;background:rgba(212,175,55,.15);border:2px solid var(--accent);color:var(--accent);font-size:1.5em;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;line-height:1}

/* prayer mini */
#prayer-mini{background:var(--secondary);border-bottom:2px solid var(--accent);padding:9px 20px;color:var(--accent);font-size:.95em;display:flex;justify-content:space-between;align-items:center}

/* notif banner */
#notif-banner{background:#1a3a2a;border:1px solid var(--accent);border-radius:15px;margin:14px;padding:14px;display:none;flex-direction:column;gap:10px}
#notif-banner p{color:var(--accent);text-align:center}
.nb-btns{display:flex;gap:10px}
.nb-allow{flex:1;padding:10px;border-radius:10px;border:none;font-weight:bold;cursor:pointer;font-family:'Amiri';background:var(--accent);color:var(--primary)}
.nb-later{flex:1;padding:10px;border-radius:10px;border:1px solid var(--accent);font-weight:bold;cursor:pointer;font-family:'Amiri';background:transparent;color:var(--accent)}

/* grid */
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:18px;padding:28px 18px;margin-top:-40px;flex-grow:1}
.card{background:var(--card);border:2px solid rgba(212,175,55,.2);border-radius:22px;padding:30px 14px;text-align:center;transition:var(--ease);cursor:pointer;box-shadow:0 12px 28px rgba(0,0,0,.08);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px}
.card:active{transform:scale(.88)}
.card-icon{font-size:2em}

/* side menu */
#side-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:7999;display:none;opacity:0;transition:opacity .3s}
#side-overlay.show{display:block;opacity:1}
#side-menu{position:fixed;top:0;right:-310px;width:290px;height:100%;background:var(--card);z-index:8000;transition:right .4s ease;box-shadow:-6px 0 28px rgba(0,0,0,.25);display:flex;flex-direction:column;overflow-y:auto}
#side-menu.open{right:0}
.side-header{background:linear-gradient(135deg,var(--primary),var(--secondary));padding:50px 18px 24px;text-align:center;border-bottom:3px solid var(--accent)}
.side-header h2{font-family:'Reem Kufi';color:var(--accent);font-size:1.5em}
.side-section{padding:12px 18px 4px;font-size:.78em;color:var(--accent);opacity:.7;letter-spacing:1px;border-top:1px solid rgba(212,175,55,.1);margin-top:6px}
.side-item{display:flex;align-items:center;gap:14px;padding:15px 18px;border-bottom:1px solid rgba(212,175,55,.07);cursor:pointer;transition:background .2s;font-size:1em}
.side-item:active{background:rgba(212,175,55,.08)}
.side-icon{font-size:1.35em;width:28px;text-align:center}
.side-toggle{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid rgba(212,175,55,.07);font-size:1em}
.tog{width:46px;height:26px;background:#555;border-radius:13px;position:relative;cursor:pointer;transition:background .3s;flex-shrink:0}
.tog.on{background:var(--accent)}
.tog::after{content:'';position:absolute;width:22px;height:22px;background:white;border-radius:50%;top:2px;right:2px;transition:transform .3s}
.tog.on::after{transform:translateX(-20px)}

/* viewer */
#viewer{display:none;position:fixed;inset:0;background:var(--bg);z-index:5000;overflow-y:auto;opacity:0;transform:scale(.96);transition:var(--ease)}
#viewer.active{display:block;opacity:1;transform:scale(1)}
.nav-bar{position:sticky;top:0;background:var(--primary);padding:12px 14px;display:flex;align-items:center;gap:9px;border-bottom:3px solid var(--accent);z-index:100}
.btn-back{background:var(--accent);color:var(--primary);border:none;padding:9px 20px;border-radius:11px;font-weight:bold;cursor:pointer;font-family:'Amiri';font-size:.93em;white-space:nowrap;flex-shrink:0}
#v-title{flex:1;text-align:center;color:var(--accent);font-family:'Reem Kufi';font-size:1.08em;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
.nic{background:transparent;border:1.5px solid rgba(212,175,55,.4);border-radius:9px;color:var(--accent);font-size:1.15em;width:38px;height:38px;display:none;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0}
.nic.vis{display:flex}

/* search panel */
#search-panel{background:var(--secondary);padding:0 0;max-height:0;overflow:hidden;transition:max-height .4s ease,padding .35s;border-bottom:2px solid transparent}
#search-panel.open{max-height:260px;padding:14px 14px;border-bottom-color:var(--accent)}
.s-inp{width:100%;padding:12px 18px;border-radius:25px;border:2px solid var(--accent);background:var(--primary);color:var(--accent);font-family:'Noto Naskh Arabic';font-size:1.05em;outline:none}
.s-inp::placeholder{color:rgba(212,175,55,.45)}
#filter-row{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.fchip{padding:6px 13px;border-radius:20px;border:1.5px solid var(--accent);background:transparent;color:var(--accent);font-family:'Amiri';font-size:.88em;cursor:pointer;transition:background .2s}
.fchip.on{background:var(--accent);color:var(--primary);font-weight:bold}

/* search results */
#sr-area{padding:8px 14px 20px;display:none}
.sr-item{background:var(--card);border-radius:14px;padding:14px;margin-bottom:10px;border-right:5px solid var(--accent);cursor:pointer}
.sr-item:active{opacity:.8}
.sr-meta{color:var(--accent);font-size:.82em;margin-bottom:8px;font-weight:bold}
.sr-txt{font-family:'Noto Naskh Arabic';font-size:1.22em;line-height:1.85}
.hl{background:rgba(212,175,55,.35);border-radius:3px;padding:0 2px}
.sr-count{padding:8px 14px;color:var(--accent);font-size:.88em}

/* ayah */
.ayah-frame{animation:fadeUp .32s ease forwards;background:var(--card);margin:11px 13px;padding:20px;border-radius:17px;border-right:7px solid var(--accent);box-shadow:0 4px 12px rgba(0,0,0,.06);position:relative}
.ayah-frame.playing{background:rgba(45,158,107,.07);border-right-color:#2d9e6b}
.ayah-frame.bookmarked{border-right-color:#e74c3c}
@keyframes fadeUp{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
.qf{font-family:'Noto Naskh Arabic',serif;line-height:2.1}
.anum{color:var(--accent);font-weight:bold}
.ayah-acts{display:flex;gap:7px;margin-top:9px;flex-wrap:wrap;align-items:center}
.ab{font-size:.78em;padding:4px 11px;border-radius:9px;border:1.5px solid var(--accent);background:transparent;color:var(--accent);cursor:pointer;font-family:'Amiri'}
.ab:active{background:rgba(212,175,55,.18)}
.ab.bmact{background:#e74c3c;border-color:#e74c3c;color:#fff}
.tf-box{background:rgba(45,106,79,.07);border-radius:10px;padding:11px;margin-top:10px;color:#2d6a4f;font-size:.92em;display:none}
.dark-mode .tf-box{background:rgba(126,200,164,.06);color:#7ec8a4}

/* font ctrl */
#font-ctrl{display:flex;align-items:center;gap:8px;margin:10px 13px;background:var(--card);border-radius:11px;padding:8px 14px;border:1px solid rgba(212,175,55,.14)}
#font-ctrl span{flex:1;text-align:center;font-size:.87em;color:var(--text);opacity:.7}
#font-ctrl button{width:33px;height:33px;border-radius:50%;border:2px solid var(--accent);background:var(--primary);color:var(--accent);font-size:1.05em;cursor:pointer}

/* auto scroll */
#asbtn{position:fixed;bottom:28px;left:28px;width:56px;height:56px;background:var(--primary);color:var(--accent);border:2px solid var(--accent);border-radius:50%;display:none;align-items:center;justify-content:center;z-index:9999;cursor:pointer;font-size:.77em;text-align:center;font-weight:bold;line-height:1.2}
#spctl{position:fixed;bottom:94px;left:32px;width:46px;height:134px;display:none;z-index:9999;flex-direction:column;align-items:center;background:var(--primary);border-radius:18px;border:1px solid var(--accent);padding:10px}
#spctl input{writing-mode:vertical-lr;direction:rtl;width:10px;height:100%;accent-color:var(--accent)}

/* sebha */
.sebha-circle{width:210px;height:210px;border-radius:50%;margin:26px auto;display:flex;align-items:center;justify-content:center;font-size:2.8em;cursor:pointer;transition:all .1s;background:radial-gradient(circle at 30% 30%,#0b2b1d,#062115);color:#fff;border:8px solid var(--accent);box-shadow:0 14px 0 #04140e,0 18px 28px rgba(0,0,0,.4);position:relative;top:0}
.sebha-circle:active{top:10px;box-shadow:0 4px 0 #04140e}

/* tabs */
.tab-bar{display:flex;gap:8px;padding:12px 13px;overflow-x:auto;-webkit-overflow-scrolling:touch}
.tbb{flex-shrink:0;padding:8px 18px;border-radius:20px;border:2px solid var(--accent);background:transparent;color:var(--accent);font-family:'Amiri';font-size:.93em;cursor:pointer}
.tbb.on{background:var(--accent);color:var(--primary);font-weight:bold}

/* prayer */
#next-card{background:linear-gradient(135deg,var(--primary),var(--secondary));border:2px solid var(--accent);border-radius:20px;margin:14px;padding:20px;text-align:center}
#next-card h3{color:var(--accent);font-family:'Reem Kufi';margin-bottom:6px}
#next-name{font-size:2em;color:#fff;font-family:'Reem Kufi'}
#next-timer{font-size:2.8em;font-family:monospace;color:var(--accent);font-weight:bold;letter-spacing:3px}
.p-row{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-radius:13px;margin:0 13px 10px;background:var(--card);border:1.5px solid rgba(212,175,55,.1)}
.p-row.acp{border-color:var(--accent);background:rgba(212,175,55,.08)}
.pn{font-size:1.1em;font-weight:bold}
.pt{color:var(--accent);font-size:1.2em;font-family:monospace}

/* bookmarks */
.bm-item{background:var(--card);border-radius:14px;margin:9px 13px;padding:13px;border-right:5px solid #e74c3c;cursor:pointer;display:flex;justify-content:space-between;align-items:center;gap:10px}
.bm-item:active{opacity:.8}

/* names */
.name-card{background:var(--card);border:2px solid rgba(212,175,55,.15);border-radius:15px;padding:17px 11px;text-align:center;cursor:pointer;transition:var(--ease)}
.name-card:active{transform:scale(.88)}

/* player bar */
#player-bar{position:sticky;bottom:0;background:var(--primary);border-top:2px solid var(--accent);padding:11px 15px;display:none;align-items:center;gap:10px;z-index:200}
#player-bar.show{display:flex}
#pinfo{flex:1;font-size:.88em;color:var(--accent);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}
#pstop{background:#8b0000;color:#fff;border:none;border-radius:10px;padding:8px 13px;cursor:pointer;font-family:'Amiri';font-size:.93em}

/* responsive */
@media(max-width:360px){header h1{font-size:2.3em}.card{padding:18px 10px}.qf{font-size:1.42em!important}}
</style>
</head>
<body>

<div id="splash">
  <div class="splash-logo">Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ±</div>
  <p style="color:rgba(255,255,255,.65);margin-top:18px">Ø¨ØµÙ…Ø© Ø¥ÙŠÙ…Ø§Ù†ÙŠØ© Ø±Ù‚Ù…ÙŠØ© Ù¢Ù Ù¢Ù¦</p>
</div>
<div id="toast"></div>

<!-- Side overlay -->
<div id="side-overlay" onclick="closeSide()"></div>

<!-- Side menu -->
<div id="side-menu">
  <div class="side-header"><h2>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2></div>

  <div class="side-section">Ø§Ù„Ù‚Ø±Ø¢Ù† ÙˆØ§Ù„Ø°ÙƒØ±</div>
  <div class="side-item" onclick="closeSide();openMod('search')"><span class="side-icon">ğŸ”</span>Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†</div>
  <div class="side-item" onclick="closeSide();openMod('bookmarks')"><span class="side-icon">ğŸ”–</span>Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ©</div>
  <div class="side-item" onclick="closeSide();openMod('khatma')"><span class="side-icon">ğŸŒŸ</span>Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©</div>

  <div class="side-section">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
  <div class="side-toggle"><span>ğŸŒ— Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span><div id="tg-dark" class="tog" onclick="toggleDark()"></div></div>
  <div class="side-toggle"><span>ğŸ”” Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©</span><div id="tg-notif" class="tog" onclick="toggleNotifSetting()"></div></div>
  <div class="side-toggle"><span>ğŸ”Š Ø£ØµÙˆØ§Øª Ø§Ù„Ø¶ØºØ·</span><div id="tg-click" class="tog" onclick="toggleClickSnd()"></div></div>

  <div class="side-section">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div>
  <div class="side-item" style="color:gray;font-size:.88em;cursor:default"><span class="side-icon">ğŸ“±</span>Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ± - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ù¢Ù Ù¢Ù¦</div>
</div>

<!-- Auto scroll -->
<div id="spctl"><input type="range" min="10" max="100" value="50" oninput="updSpd(this.value)"></div>
<div id="asbtn" onclick="togScroll()">Ù†Ø²ÙˆÙ„<br>ØªÙ„Ù‚Ø§Ø¦ÙŠ</div>

<!-- HOME -->
<div id="home-screen">
  <header>
    <div id="menu-btn" onclick="openSide()">â‹®</div>
    <h1>Ù…ØµØ­Ù Ø§Ù„Ù†ÙˆØ±</h1>
    <p>ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø§Ù„Ø¥ÙŠÙ…Ø§Ù†ÙŠ Ø§Ù„Ù…ÙØ¶Ù„</p>
  </header>
  <div id="prayer-mini">
    <span id="mn-name">â³ ØªØ­Ù…ÙŠÙ„...</span>
    <span id="mn-timer" style="font-family:monospace">--:--:--</span>
  </div>
  <div id="notif-banner">
    <p>ğŸ”” ÙØ¹Ù‘Ù„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ØµÙ„Ø§Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</p>
    <div class="nb-btns">
      <button class="nb-allow" onclick="reqNotif()">ØªÙØ¹ÙŠÙ„</button>
      <button class="nb-later" onclick="dismissBanner()">Ù„Ø§Ø­Ù‚Ø§Ù‹</button>
    </div>
  </div>
  <div class="grid">
    <div class="card" onclick="ck();openMod('quran')"><span class="card-icon">ğŸ“–</span><b>Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…</b></div>
    <div class="card" onclick="ck();openMod('azkar')"><span class="card-icon">ğŸ“¿</span><b>Ø§Ù„Ø£Ø°ÙƒØ§Ø±</b></div>
    <div class="card" onclick="ck();openMod('prayers')"><span class="card-icon">ğŸ•Œ</span><b>Ø§Ù„Ù…ÙˆØ§Ù‚ÙŠØª</b></div>
    <div class="card" onclick="ck();openMod('tasbih')"><span class="card-icon">ğŸ”¢</span><b>Ø§Ù„Ø³Ø¨Ø­Ø©</b></div>
    <div class="card" onclick="ck();openMod('reciters')"><span class="card-icon">ğŸ™ï¸</span><b>Ø§Ù„ØªÙ„Ø§ÙˆØ§Øª</b></div>
    <div class="card" onclick="ck();openMod('names')"><span class="card-icon">âœ¨</span><b>Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡</b></div>
  </div>
</div>

<!-- VIEWER -->
<div id="viewer">
  <div class="nav-bar">
    <button class="btn-back" onclick="doBack()">Ø±Ø¬ÙˆØ¹</button>
    <div id="v-title"></div>
    <button class="nic" id="nic-search" onclick="togSearchPanel()" title="Ø¨Ø­Ø«">ğŸ”</button>
    <button class="nic vis" onclick="openSide()" title="Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â‹®</button>
  </div>
  <!-- Search panel -->
  <div id="search-panel">
    <input class="s-inp" id="s-inp" type="search" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¢ÙŠØ© Ø£Ùˆ ÙƒÙ„Ù…Ø©..." autocomplete="off" oninput="debSearch(this.value)">
    <div id="filter-row">
      <button class="fchip on" onclick="setFlt(this,'all')">ÙƒÙ„ Ø§Ù„Ù‚Ø±Ø¢Ù†</button>
      <button class="fchip" onclick="setFlt(this,'surah')">Ø§Ù„Ø³ÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</button>
      <button class="fchip" onclick="setFlt(this,'exact')">ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…</button>
    </div>
  </div>
  <div id="sr-area"></div>
  <div id="v-body"></div>
  <!-- Audio player bar -->
  <div id="player-bar">
    <div id="pinfo">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„...</div>
    <button id="pstop" onclick="stopAud()">â¹ Ø¥ÙŠÙ‚Ø§Ù</button>
  </div>
</div>

<audio id="aud" crossorigin="anonymous" preload="none"></audio>

<!-- Firebase -->
<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import{getDatabase,ref,set,onValue,get}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
const cfg={apiKey:"AIzaSyBKc0Vu8e1WxyUTmd1dEpGgrKDNOQV9PsY",authDomain:"quranapp-9c312.firebaseapp.com",projectId:"quranapp-9c312",databaseURL:"https://quranapp-9c312-default-rtdb.firebaseio.com/",storageBucket:"quranapp-9c312.firebasestorage.app",messagingSenderId:"708147485092",appId:"1:708147485092:web:ce228b7a245a89f08b0931"};
const app=initializeApp(cfg);const db=getDatabase(app);
window._fb={db,ref,set,onValue,get};
</script>

<script>
/* ============================================================
   GLOBALS
============================================================ */
let quranXml=null,prayerTimes=null,countInv=null,miniInv=null;
let isScroll=false,scrollInv=null,scrollSpd=50;
let fontSize=1.8;
let bookmarks=JSON.parse(localStorage.getItem('bm')||'[]');
let clickOn=localStorage.getItem('clickSnd')!=='false';
let sDeb=null,activeFilter='all',curSurahId=null,curRecBase=null,curRecName=null;
let notifSched=false;
const navStack=[];

const G=id=>document.getElementById(id);
const aud=G('aud'),viewer=G('viewer'),vBody=G('v-body'),vTitle=G('v-title'),toast=G('toast');
let sCount=parseInt(localStorage.getItem('tasbihCount')||'0');

/* ============================================================
   AUDIO CTX (click sounds)
============================================================ */
let _actx=null;
function gctx(){
  if(!_actx)_actx=new(window.AudioContext||window.webkitAudioContext)();
  if(_actx.state==='suspended')_actx.resume();
  return _actx;
}
function ck(){
  if(!clickOn)return;
  try{const c=gctx(),o=c.createOscillator(),g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=800;o.type='sine';g.gain.setValueAtTime(.12,c.currentTime);g.gain.exponentialRampToValueAtTime(.001,c.currentTime+.1);o.start(c.currentTime);o.stop(c.currentTime+.1);}catch(e){}
}
function ckOk(){
  if(!clickOn)return;
  try{const c=gctx();[523,659,784].forEach((f,i)=>{const o=c.createOscillator(),g=c.createGain();o.connect(g);g.connect(c.destination);o.frequency.value=f;g.gain.setValueAtTime(.08,c.currentTime+i*.11);g.gain.exponentialRampToValueAtTime(.001,c.currentTime+i*.11+.17);o.start(c.currentTime+i*.11);o.stop(c.currentTime+i*.11+.17);});}catch(e){}
}
// Ù†ÙØ³ Ø§Ù„Ù€ unlock Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ - Ø¶Ø±ÙˆØ±ÙŠ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
document.addEventListener('click', function unlockAudio() {
  aud.play().then(()=>{ aud.pause(); aud.currentTime=0; }).catch(()=>{});
  document.removeEventListener('click', unlockAudio);
}, {once:true});


/* ============================================================
   HELPERS
============================================================ */
function toAr(n){return String(n).replace(/\d/g,d=>'Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©'[d]);}
function sh(msg){toast.textContent=msg;toast.classList.add('show');clearTimeout(toast._t);toast._t=setTimeout(()=>toast.classList.remove('show'),2700);}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');}
function safeAttr(s){return String(s).replace(/'/g,'&#39;').replace(/"/g,'&quot;');}

/* ============================================================
   SIDE MENU
============================================================ */
function openSide(){ck();G('side-menu').classList.add('open');G('side-overlay').classList.add('show');}
function closeSide(){G('side-menu').classList.remove('open');G('side-overlay').classList.remove('show');}
function refToggles(){
  G('tg-dark').classList.toggle('on',document.body.classList.contains('dark-mode'));
  G('tg-notif').classList.toggle('on',typeof Notification!=='undefined'&&Notification.permission==='granted');
  G('tg-click').classList.toggle('on',clickOn);
}
function toggleDark(){ck();document.body.classList.toggle('dark-mode');localStorage.setItem('darkMode',document.body.classList.contains('dark-mode'));refToggles();}
function toggleNotifSetting(){ck();if(typeof Notification==='undefined'){sh('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');return;}if(Notification.permission!=='granted')reqNotif();else sh('Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ù…ÙØ¹Ù‘Ù„Ø© Ø¨Ø§Ù„ÙØ¹Ù„');}
function toggleClickSnd(){clickOn=!clickOn;localStorage.setItem('clickSnd',clickOn);refToggles();sh(clickOn?'ğŸ”Š Ø§Ù„Ø£ØµÙˆØ§Øª Ù…ÙØ¹Ù‘Ù„Ø©':'ğŸ”‡ Ø§Ù„Ø£ØµÙˆØ§Øª Ù…ÙƒØªÙˆÙ…Ø©');}

/* ============================================================
   VIEWER NAVIGATION
============================================================ */
function openViewer(){
  viewer.style.display='block';
  setTimeout(()=>viewer.classList.add('active'),10);
  G('search-panel').classList.remove('open');
  G('sr-area').style.display='none';
  G('nic-search').classList.remove('vis');
  G('player-bar').classList.remove('show');
  G('asbtn').style.display='none';
  G('spctl').style.display='none';
}
function openMod(type){
  ck();navStack.length=0;
  openViewer();
  route(type);
}
function route(t){
  if(t==='quran')renderSurahList();
  else if(t==='azkar')renderAzkar();
  else if(t==='prayers')renderPrayers();
  else if(t==='tasbih')renderTasbih();
  else if(t==='reciters')renderReciters();
  else if(t==='names')renderNames();
  else if(t==='khatma')renderKhatma();
  else if(t==='bookmarks')renderBookmarks();
  else if(t==='search')renderSearchPage();
}
function doBack(){
  ck();clearInterval(countInv);stopScroll();
  G('search-panel').classList.remove('open');
  G('sr-area').style.display='none';
  G('asbtn').style.display='none';
  G('spctl').style.display='none';
  if(navStack.length>0){const fn=navStack.pop();fn();}
  else{viewer.classList.remove('active');setTimeout(()=>viewer.style.display='none',440);}
  aud.pause();
}
function pushNav(fn){navStack.push(fn);}

/* ============================================================
   ONLOAD
============================================================ */
window.addEventListener('load',async()=>{
  setTimeout(()=>{G('splash').style.opacity='0';setTimeout(()=>G('splash').style.display='none',900);},2000);
  if(localStorage.getItem('darkMode')==='true')document.body.classList.add('dark-mode');
  refToggles();
  try{const r=await fetch('quran-simple.xml');const t=await r.text();quranXml=new DOMParser().parseFromString(t,'text/xml');}catch(e){}
  await loadPrayers();
  startMini();
  if(typeof Notification!=='undefined'&&Notification.permission==='default'&&!localStorage.getItem('nd')){
    G('notif-banner').style.display='flex';
  }
  if('serviceWorker' in navigator)navigator.serviceWorker.register('sw.js').then(r=>window.swReg=r).catch(()=>{});
});

/* ============================================================
   PRAYER TIMES
============================================================ */
async function loadPrayers(){
  const c=localStorage.getItem('pt'),cd=localStorage.getItem('ptd'),today=new Date().toDateString();
  if(c&&cd===today){prayerTimes=JSON.parse(c);return;}
  try{
    const r=await fetch('https://api.aladhan.com/v1/timingsByCity?city=Cairo&country=Egypt&method=5');
    const d=await r.json();
    if(d.data){prayerTimes=d.data.timings;localStorage.setItem('pt',JSON.stringify(prayerTimes));localStorage.setItem('ptd',today);}
  }catch(e){if(c)prayerTimes=JSON.parse(c);}
}
function nextPrayer(){
  if(!prayerTimes)return null;
  const ks=['Fajr','Dhuhr','Asr','Maghrib','Isha'],ns={Fajr:'Ø§Ù„ÙØ¬Ø±',Dhuhr:'Ø§Ù„Ø¸Ù‡Ø±',Asr:'Ø§Ù„Ø¹ØµØ±',Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨',Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡'};
  const now=new Date();
  for(const k of ks){
    if(!prayerTimes[k])continue;
    const[h,m]=prayerTimes[k].split(':');const t=new Date();t.setHours(+h,+m,0,0);
    if(t>now)return{name:ns[k],time:t,key:k};
  }
  const[h,m]=(prayerTimes.Fajr||'05:00').split(':');
  const t=new Date();t.setDate(t.getDate()+1);t.setHours(+h,+m,0,0);
  return{name:'Ø§Ù„ÙØ¬Ø±',time:t,key:'Fajr'};
}
function fmtDiff(ms){
  const h=Math.floor(ms/3600000),m=Math.floor((ms%3600000)/60000),s=Math.floor((ms%60000)/1000);
  return`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}
function startMini(){
  clearInterval(miniInv);
  miniInv=setInterval(()=>{
    const nx=nextPrayer();if(!nx)return;
    const diff=nx.time-new Date();if(diff<0)return;
    G('mn-name').textContent='ğŸ•Œ '+nx.name;
    G('mn-timer').textContent=toAr(fmtDiff(diff));
    if(diff<300000&&diff>290000)notifPrayer(nx.name,Math.round(diff/60000));
  },1000);
}
function startCountdown(){
  clearInterval(countInv);
  countInv=setInterval(()=>{
    const nx=nextPrayer();if(!nx)return;
    const diff=nx.time-new Date();if(diff<0)return;
    const ne=G('next-name'),te=G('next-timer');
    if(ne)ne.textContent=nx.name;if(te)te.textContent=toAr(fmtDiff(diff));
    document.querySelectorAll('.p-row').forEach(r=>r.classList.remove('acp'));
    const rw=G('row-'+nx.key);if(rw)rw.classList.add('acp');
  },1000);
}

/* ============================================================
   NOTIFICATIONS
============================================================ */
async function reqNotif(){
  ck();
  if(typeof Notification==='undefined'){sh('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');return;}
  const p=await Notification.requestPermission();
  G('notif-banner').style.display='none';
  if(p==='granted'){sh('âœ… ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª');schedNotifs();}
  else sh('Ù„Ù… ÙŠØªÙ… Ù…Ù†Ø­ Ø§Ù„Ø¥Ø°Ù†');
  refToggles();
}
function dismissBanner(){G('notif-banner').style.display='none';localStorage.setItem('nd','1');}
function notifPrayer(name,mins){
  if(typeof Notification==='undefined'||Notification.permission!=='granted')return;
  if(notifSched)return;notifSched=true;setTimeout(()=>notifSched=false,65000);
  const opts={body:`Ø¨Ø§Ù‚ÙŠ ${toAr(mins)} Ø¯Ù‚Ø§Ø¦Ù‚ Ø¹Ù„Ù‰ ØµÙ„Ø§Ø© ${name}`,icon:'./icon.png',dir:'rtl',vibrate:[200,100,200],tag:'ps'};
  if(window.swReg)window.swReg.showNotification(`ğŸ•Œ Ù‚Ø±ÙŠØ¨Ø§Ù‹: ${name}`,opts);
  else new Notification(`ğŸ•Œ Ù‚Ø±ÙŠØ¨Ø§Ù‹: ${name}`,opts);
}
function schedNotifs(){
  if(!prayerTimes||typeof Notification==='undefined'||Notification.permission!=='granted')return;
  const ns={Fajr:'Ø§Ù„ÙØ¬Ø±',Dhuhr:'Ø§Ù„Ø¸Ù‡Ø±',Asr:'Ø§Ù„Ø¹ØµØ±',Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨',Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡'};const now=new Date();
  for(const[k,n]of Object.entries(ns)){
    if(!prayerTimes[k])continue;
    const[h,m]=prayerTimes[k].split(':');const pt=new Date();pt.setHours(+h,+m,0,0);
    const delay=pt-now-5*60000;if(delay>0)setTimeout(()=>{if(window.swReg)window.swReg.showNotification(`ğŸ•Œ Ø­Ø§Ù† ÙˆÙ‚Øª ${n}`,{body:'Ø§Ù„ØµÙ„Ø§Ø© Ø®ÙŠØ± Ù…Ù† Ø§Ù„Ù†ÙˆÙ…',icon:'./icon.png',dir:'rtl',vibrate:[300,100,300,100,300],tag:'p'+k});},delay);
  }
  sh('âœ… ØªÙ… Ø¬Ø¯ÙˆÙ„Ø© ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„ØµÙ„Ø§Ø©');
}

/* ============================================================
   SEARCH
============================================================ */
function togSearchPanel(){ck();const p=G('search-panel');const op=p.classList.toggle('open');G('sr-area').style.display=op?'block':'none';if(op)setTimeout(()=>G('s-inp').focus(),300);}
function setFlt(btn,f){ck();activeFilter=f;document.querySelectorAll('.fchip').forEach(c=>c.classList.remove('on'));btn.classList.add('on');const q=G('s-inp').value.trim();if(q.length>=2)doSearch(q);}
function debSearch(v){clearTimeout(sDeb);if(v.trim().length<2){G('sr-area').innerHTML='';return;}sDeb=setTimeout(()=>doSearch(v.trim()),500);}

async function doSearch(q){
  const area=G('sr-area');area.style.display='block';area.innerHTML='<p style="padding:14px;color:var(--accent)">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...</p>';
  try{
    const scope=(activeFilter==='surah'&&curSurahId)?curSurahId:'all';
    const url=`https://api.alquran.cloud/v1/search/${encodeURIComponent(q)}/${scope}/ar`;
    const r=await fetch(url);const d=await r.json();
    if(!d.data||!d.data.matches||!d.data.matches.length){area.innerHTML='<p style="padding:20px;text-align:center;color:gray">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</p>';return;}
    let ms=d.data.matches;
    if(activeFilter==='exact'){const re=new RegExp('(^|\\s)'+q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')+'(\\s|$)');ms=ms.filter(m=>re.test(m.text));}
    if(!ms.length){area.innerHTML='<p style="padding:20px;text-align:center;color:gray">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ø¨Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¯Ù‚ÙŠÙ‚</p>';return;}
    let html=`<div class="sr-count">ğŸ” ÙˆØ¬Ø¯ ${toAr(ms.length)} Ù†ØªÙŠØ¬Ø©</div>`;
    ms.slice(0,60).forEach(m=>{
      html+=`<div class="sr-item" onclick="fromSearch(${m.surah.number},'${safeAttr(m.surah.name)}',${m.number})">
        <div class="sr-meta">${esc(m.surah.name)} â€¢ Ø¢ÙŠØ© ${toAr(m.numberInSurah)}</div>
        <div class="sr-txt">${hlText(m.text,q)}</div></div>`;
    });
    area.innerHTML=html;
  }catch(e){
    if(quranXml)offSearch(q,area);
    else area.innerHTML='<p style="padding:20px;text-align:center;color:gray">ØªØ­ØªØ§Ø¬ Ø§ØªØµØ§Ù„Ø§Ù‹ Ù„Ù„Ø¨Ø­Ø«</p>';
  }
}
function hlText(txt,q){
  const s=esc(txt);const sq=esc(q).replace(/[.*+?^${}()|[\]\\]/g,'\\$&');
  return s.replace(new RegExp(sq,'g'),'<span class="hl">$&</span>');
}
function offSearch(q,area){
  const ayahs=quranXml.querySelectorAll('aya');let res=[],cnt=0;
  ayahs.forEach(a=>{if(cnt>=40)return;const t=a.getAttribute('text')||'';if(t.includes(q)){const su=a.parentElement;res.push({t,i:+a.getAttribute('index'),sn:su.getAttribute('name'),si:+su.getAttribute('index')});cnt++;}});
  if(!res.length){area.innerHTML='<p style="padding:20px;text-align:center;color:gray">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ (Ø£ÙˆÙÙ„Ø§ÙŠÙ†)</p>';return;}
  let html=`<div class="sr-count">ğŸ” ÙˆØ¬Ø¯ ${toAr(res.length)} Ù†ØªÙŠØ¬Ø© (Ø£ÙˆÙÙ„Ø§ÙŠÙ†)</div>`;
  res.forEach(r=>{html+=`<div class="sr-item" onclick="fromSearch(${r.si},'${safeAttr(r.sn)}',null)"><div class="sr-meta">${esc(r.sn)} â€¢ Ø¢ÙŠØ© ${toAr(r.i)}</div><div class="sr-txt">${hlText(r.t,q)}</div></div>`;});
  area.innerHTML=html;
}
async function fromSearch(sNum,sName,ayahNum){
  ck();G('search-panel').classList.remove('open');G('sr-area').style.display='none';
  pushNav(renderSearchPage);
  await renderAyahs(sNum,sName);
  if(ayahNum){setTimeout(()=>{const el=G('ayah-'+ayahNum);if(el)el.scrollIntoView({behavior:'smooth',block:'center'});},650);}
}
function renderSearchPage(){
  vTitle.textContent='Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù†';
  G('nic-search').classList.add('vis');
  G('search-panel').classList.add('open');
  G('sr-area').style.display='block';
  G('sr-area').innerHTML='<p style="padding:30px;text-align:center;color:gray;font-size:.93em">Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ø£Ùˆ Ø¬Ø²Ø¡Ø§Ù‹ Ù…Ù† Ø¢ÙŠØ© Ù„Ù„Ø¨Ø­Ø«</p>';
  vBody.innerHTML='';
  setTimeout(()=>G('s-inp').focus(),350);
}

/* ============================================================
   SURAH LIST
============================================================ */
async function renderSurahList(){
  vTitle.textContent='ÙÙ‡Ø±Ø³ Ø§Ù„Ø³ÙˆØ±';
  G('nic-search').classList.add('vis');
  G('asbtn').style.display='none';G('spctl').style.display='none';
  vBody.innerHTML='<p style="text-align:center;padding:40px">â³ ØªØ­Ù…ÙŠÙ„...</p>';
  curSurahId=null;
  const tabs=`<div class="tab-bar"><button class="tbb on" onclick="ck();renderSurahList()">Ø§Ù„Ø³ÙˆØ±</button><button class="tbb" onclick="ck();renderJuzList()">Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡</button></div>`;
  try{
    const r=await fetch('https://api.alquran.cloud/v1/surah');const d=await r.json();
    let html=tabs+'<div class="grid" style="margin-top:0">';
    d.data.forEach(s=>{html+=`<div class="card" onclick="ck();pushNav(renderSurahList);renderAyahs(${s.number},'${safeAttr(s.name)}')"><b>${esc(s.name)}</b><small style="color:gray;font-size:.78em">${toAr(s.numberOfAyahs)} Ø¢ÙŠØ©</small></div>`;});
    vBody.innerHTML=html+'</div>';
  }catch(e){
    if(quranXml){
      const ss=quranXml.querySelectorAll('sura');let html=tabs+'<div class="grid" style="margin-top:0">';
      ss.forEach(s=>{html+=`<div class="card" onclick="ck();pushNav(renderSurahList);renderAyahs(${s.getAttribute('index')},'${safeAttr(s.getAttribute('name'))}')"><b>${esc(s.getAttribute('name'))}</b></div>`;});
      vBody.innerHTML=html+'</div>';
    }else vBody.innerHTML='<p style="text-align:center;padding:40px">ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„</p>';
  }
}

/* ============================================================
   JUZ LIST
============================================================ */
function renderJuzList(){
  vTitle.textContent='Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ Ø§Ù„Ø«Ù„Ø§Ø«ÙˆÙ†';
  const tabs=`<div class="tab-bar"><button class="tbb" onclick="ck();renderSurahList()">Ø§Ù„Ø³ÙˆØ±</button><button class="tbb on" onclick="ck();renderJuzList()">Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡</button></div>`;
  let html=tabs+'<div class="grid" style="margin-top:0">';
  for(let i=1;i<=30;i++)html+=`<div class="card" onclick="ck();pushNav(renderJuzList);renderJuzAyahs(${i})"><b>Ø§Ù„Ø¬Ø²Ø¡ ${toAr(i)}</b></div>`;
  vBody.innerHTML=html+'</div>';
}

async function renderJuzAyahs(jn){
  vTitle.textContent='Ø§Ù„Ø¬Ø²Ø¡ '+toAr(jn);
  G('asbtn').style.display='flex';G('spctl').style.display='flex';
  vBody.innerHTML='<p style="text-align:center;padding:40px">â³ ØªØ­Ù…ÙŠÙ„...</p>';
  try{
    const r=await fetch(`https://api.alquran.cloud/v1/juz/${jn}/ar.alafasy`);const d=await r.json();
    let html=fctrl();
    d.data.ayahs.forEach(a=>{const bm=bookmarks.find(b=>b.num===a.number);html+=buildAyah(a.number,a.text,ayahAudioUrl(a.number),a.numberInSurah,a.surah.name,a.surah.number,bm,'');});
    vBody.innerHTML=html;
  }catch(e){vBody.innerHTML='<p style="text-align:center;padding:30px">ØªØ­ØªØ§Ø¬ Ø§ØªØµØ§Ù„Ø§Ù‹ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø²Ø¡</p>';}
  viewer.scrollTo(0,0);
}

/* ============================================================
   SURAH AYAHS
============================================================ */
// Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØª Ù…Ù† everyayah.com - Ù…ÙˆØ«ÙˆÙ‚ Ù„ÙƒÙ„ Ø¢ÙŠØ© Ø¨Ø±Ù‚Ù…Ù‡Ø§ Ø§Ù„Ù…Ø·Ù„Ù‚
// Ù…Ø«Ø§Ù„: Ø¢ÙŠØ© 1 Ù…Ù† Ø§Ù„Ù‚Ø±Ø¢Ù† (Ø§Ù„ÙØ§ØªØ­Ø©:1) = 000001.mp3
// Ù†Ø­Ø³Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø·Ù„Ù‚ Ù„Ù„Ø¢ÙŠØ© Ù…Ù† API field: a.number
function ayahAudioUrl(absoluteNum){
  return `https://everyayah.com/data/Alafasy_128kbps/${String(absoluteNum).padStart(6,'0')}.mp3`;
}

async function renderAyahs(id,name){
  vTitle.textContent='Ø³ÙˆØ±Ø© '+name;curSurahId=id;
  G('nic-search').classList.add('vis');
  G('asbtn').style.display='flex';G('spctl').style.display='flex';
  vBody.innerHTML='<p style="text-align:center;padding:40px">â³ ØªØ­Ù…ÙŠÙ„...</p>';
  try{
    const[ar,tf]=await Promise.all([
      fetch(`https://api.alquran.cloud/v1/surah/${id}/ar.alafasy`),
      fetch(`https://api.alquran.cloud/v1/surah/${id}/ar.jalalayn`)
    ]);
    const arD=await ar.json(),tfD=await tf.json();
    let html=fctrl();
    arD.data.ayahs.forEach((a,i)=>{
      const bm=bookmarks.find(b=>b.num===a.number);
      const tf2=tfD.data?.ayahs?.[i]?.text||'';
      // a.number = Ø±Ù‚Ù… Ø§Ù„Ø¢ÙŠØ© Ø§Ù„Ù…Ø·Ù„Ù‚ ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† ÙƒÙ„Ù‡ (1 Ù„Ù„ÙØ§ØªØ­Ø©:1ØŒ Ø¥Ù„Ø®)
      const audioUrl = ayahAudioUrl(a.number);
      html+=buildAyah(a.number,a.text,audioUrl,a.numberInSurah,name,id,bm,tf2);
    });
    vBody.innerHTML=html;
  }catch(e){
    if(quranXml){
      const sura=quranXml.querySelector(`sura[index="${id}"]`);
      if(!sura){vBody.innerHTML='<p style="text-align:center;padding:40px">Ø§Ù„Ø³ÙˆØ±Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£ÙˆÙÙ„Ø§ÙŠÙ†</p>';return;}
      const ayahs=sura.querySelectorAll('aya');let html=fctrl(),body='';
      ayahs.forEach(a=>{
        if(a.getAttribute('bismillah'))body+=`<div style="text-align:center;color:var(--accent);font-weight:bold;font-size:1.2em;margin-bottom:16px">${esc(a.getAttribute('bismillah'))}</div>`;
        body+=`${esc(a.getAttribute('text'))} <span class="anum">ï´¿${toAr(a.getAttribute('index'))}ï´¾</span> `;
      });
      html+=`<div class="ayah-frame"><div class="qf" style="font-size:${fontSize}em;text-align:justify;line-height:2.2">${body}</div><p style="text-align:center;color:gray;font-size:.8em;margin-top:14px">(ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙˆÙÙ„Ø§ÙŠÙ† â€“ Ø§Ù„ØµÙˆØª ØºÙŠØ± Ù…ØªØ§Ø­)</p></div>`;
      vBody.innerHTML=html;
    }
  }
  viewer.scrollTo(0,0);
}

/* â”€â”€ build ayah block â”€â”€ */
function buildAyah(num,text,audioUrl,numInS,sName,sId,bm,tafsir){
  const bmCls=bm?' bookmarked':'';
  const bmBtnCls=bm?' bmact':'';
  const safeAud=esc(audioUrl||'');
  const safeSn=safeAttr(sName);
  const tfBlock=tafsir?`<div class="tf-box" id="tf${num}">${esc(tafsir)}</div>`:'';
  const tfBtn=tafsir?`<button class="ab" onclick="event.stopPropagation();togTf(${num})">Ø§Ù„ØªÙØ³ÙŠØ±</button>`:'';
  return `<div class="ayah-frame${bmCls}" id="ayah-${num}" onclick="playSaut('${safeAud}',${num})">
  <div class="qf" style="font-size:${fontSize}em">${esc(text)} <span class="anum">ï´¿${toAr(numInS)}ï´¾</span></div>
  <div class="ayah-acts">
    <button class="ab${bmBtnCls}" id="bmbtn${num}" onclick="event.stopPropagation();togBm(${num},'${safeSn}',${numInS},${sId})">ğŸ”–</button>
    <button class="ab" onclick="event.stopPropagation();cpAyah('${esc(text)} ï´¿${numInS}ï´¾ - ${esc(sName)}')">Ù†Ø³Ø®</button>
    ${tfBtn}
  </div>
  ${tfBlock}
</div>`;
}

function fctrl(){return`<div id="font-ctrl"><button onclick="chFont(-.2)">Ø£âˆ’</button><span>Ø­Ø¬Ù… Ø§Ù„Ø®Ø·</span><button onclick="chFont(.2)">Ø£+</button></div>`;}
function chFont(d){fontSize=Math.max(1,Math.min(3,fontSize+d));document.querySelectorAll('.qf').forEach(e=>e.style.fontSize=fontSize+'em');}

/* play ayah audio - Ù†ÙØ³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ */
function playSaut(url,num){
  if(!url)return;
  ck();
  document.querySelectorAll('.ayah-frame').forEach(f=>f.classList.remove('playing'));
  const f=G('ayah-'+num);if(f)f.classList.add('playing');
  aud.src=url;
  aud.play().catch(err=>console.warn('audio err:',err));
}
aud.addEventListener('ended',()=>document.querySelectorAll('.ayah-frame.playing').forEach(f=>f.classList.remove('playing')));

function cpAyah(t){navigator.clipboard.writeText(t).then(()=>sh('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø®')).catch(()=>sh('ØªØ¹Ø°Ø± Ø§Ù„Ù†Ø³Ø®'));}
function togTf(n){ck();const b=G('tf'+n);if(b)b.style.display=b.style.display==='block'?'none':'block';}

/* ============================================================
   BOOKMARKS
============================================================ */
function togBm(num,sName,ayahInS,sId){
  ck();const idx=bookmarks.findIndex(b=>b.num===num);
  const btn=G('bmbtn'+num),frame=G('ayah-'+num);
  if(idx>=0){
    bookmarks.splice(idx,1);sh('ğŸ—‘ï¸ ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø§Ø±Ø©');
    if(btn)btn.classList.remove('bmact');if(frame)frame.classList.remove('bookmarked');
  }else{
    bookmarks.push({num,surah:sName,surahId:sId,ayah:ayahInS,date:new Date().toLocaleDateString('ar')});
    sh('ğŸ”– ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©');ckOk();if(navigator.vibrate)navigator.vibrate(60);
    if(btn)btn.classList.add('bmact');if(frame)frame.classList.add('bookmarked');
  }
  localStorage.setItem('bm',JSON.stringify(bookmarks));
}
function renderBookmarks(){
  vTitle.textContent='Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø¬Ø¹ÙŠØ© ğŸ”–';
  if(!bookmarks.length){vBody.innerHTML='<div style="text-align:center;padding:60px"><div style="font-size:4em">ğŸ”–</div><p style="color:gray;margin-top:16px">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø§Ø±Ø§Øª Ù…Ø±Ø¬Ø¹ÙŠØ©<br>Ø§Ø¶ØºØ· ğŸ”– Ø¨Ø¬Ø§Ù†Ø¨ Ø£ÙŠ Ø¢ÙŠØ©</p></div>';return;}
  let html=`<p style="padding:14px;color:var(--accent)">${toAr(bookmarks.length)} Ø¥Ø´Ø§Ø±Ø© Ù…Ø­ÙÙˆØ¸Ø©</p>`;
  bookmarks.forEach(bm=>{
    html+=`<div class="bm-item" onclick="ck();goBm(${bm.surahId||0},'${safeAttr(bm.surah)}',${bm.num})">
      <div><div style="color:var(--accent);font-weight:bold">Ø³ÙˆØ±Ø© ${esc(bm.surah)} - Ø¢ÙŠØ© ${toAr(bm.ayah)}</div><div style="color:gray;font-size:.82em;margin-top:4px">${esc(bm.date)}</div></div>
      <button onclick="event.stopPropagation();delBm(${bm.num})" style="background:#8b0000;color:#fff;border:none;border-radius:9px;padding:7px 13px;cursor:pointer;font-family:'Amiri';flex-shrink:0">Ø­Ø°Ù</button>
    </div>`;
  });
  vBody.innerHTML=html;
}
function delBm(num){ck();bookmarks=bookmarks.filter(b=>b.num!==num);localStorage.setItem('bm',JSON.stringify(bookmarks));renderBookmarks();}
async function goBm(sId,sName,ayahNum){
  pushNav(renderBookmarks);
  if(sId){await renderAyahs(sId,sName);}
  else{
    try{const r=await fetch('https://api.alquran.cloud/v1/surah');const d=await r.json();const s=d.data.find(x=>x.name===sName);if(s)await renderAyahs(s.number,s.name);else{sh('ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆØ±Ø©');return;}}
    catch(e){sh('ØªØ­ØªØ§Ø¬ Ø§ØªØµØ§Ù„Ø§Ù‹ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„');return;}
  }
  setTimeout(()=>{const el=G('ayah-'+ayahNum);if(el)el.scrollIntoView({behavior:'smooth',block:'center'});},700);
}

/* ============================================================
   AUTO SCROLL
============================================================ */
function updSpd(v){scrollSpd=110-v;if(isScroll){clearInterval(scrollInv);startScroll();}}
function togScroll(){if(isScroll){stopScroll();sh('ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù');}else{isScroll=true;G('asbtn').innerHTML='Ø¥ÙŠÙ‚Ø§Ù';startScroll();sh('Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø²ÙˆÙ„ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');}}
function startScroll(){scrollInv=setInterval(()=>viewer.scrollTop+=1,scrollSpd);}
function stopScroll(){clearInterval(scrollInv);isScroll=false;G('asbtn').innerHTML='Ù†Ø²ÙˆÙ„<br>ØªÙ„Ù‚Ø§Ø¦ÙŠ';}

/* ============================================================
   RECITERS â€” proper back navigation
============================================================ */
function renderReciters(){
  vTitle.textContent='Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦';
  G('player-bar').classList.remove('show');
  curRecBase=null;curRecName=null;
  const rec=[
    {n:'ÙŠØ§Ø³Ø± Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ',b:'https://server11.mp3quran.net/yasser/'},
    {n:'Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ',b:'https://server8.mp3quran.net/afs/'},
    {n:'Ø¹Ø¨Ø¯Ø§Ù„Ø¨Ø§Ø³Ø· Ø¹Ø¨Ø¯Ø§Ù„ØµÙ…Ø¯',b:'https://server7.mp3quran.net/basit/'},
    {n:'Ù…Ø­Ù…Ø¯ Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ',b:'https://server10.mp3quran.net/minsh/'}
  ];
  let html='<div class="grid" style="margin-top:20px">';
  rec.forEach(r=>{html+=`<div class="card" onclick="ck();pushNav(renderReciters);loadRecSurahs('${safeAttr(r.b)}','${safeAttr(r.n)}')"><span style="font-size:2em">ğŸ™ï¸</span><b>${esc(r.n)}</b></div>`;});
  vBody.innerHTML=html+'</div>';
}
async function loadRecSurahs(base,rName){
  vTitle.textContent='ØªÙ„Ø§ÙˆØ© '+rName;curRecBase=base;curRecName=rName;
  vBody.innerHTML='<p style="text-align:center;padding:30px">â³ ØªØ­Ù…ÙŠÙ„...</p>';
  try{
    const r=await fetch('https://api.alquran.cloud/v1/surah');const d=await r.json();
    let html='<div class="grid" style="margin-top:0">';
    d.data.forEach(s=>{html+=`<div class="card" onclick="ck();playRec('${safeAttr(base)}',${s.number},'${safeAttr(s.name)}')"><b>${esc(s.name)}</b></div>`;});
    vBody.innerHTML=html+'</div>';
  }catch(e){vBody.innerHTML='<p style="text-align:center;padding:40px">Ø§Ù„ØªÙ„Ø§ÙˆØ§Øª ØªØ­ØªØ§Ø¬ Ø§ØªØµØ§Ù„Ø§Ù‹ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>';}
}
function playRec(base,sNum,sName){
  ck();
  const url=`${base}${String(sNum).padStart(3,'0')}.mp3`;
  aud.src=url;
  aud.play().catch(()=>sh('ØªØ¹Ø°Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ â€“ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„'));
  sh('â–¶ '+sName);
  G('pinfo').textContent=sName+' â€“ '+(curRecName||'');
  G('player-bar').classList.add('show');
}
function stopAud(){ck();aud.pause();aud.currentTime=0;G('player-bar').classList.remove('show');document.querySelectorAll('.ayah-frame.playing').forEach(f=>f.classList.remove('playing'));sh('â¹ ØªÙ… Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù');}

/* ============================================================
   TASBIH
============================================================ */
function renderTasbih(){
  vTitle.textContent='Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©';
  sCount=parseInt(localStorage.getItem('tasbihCount')||'0');
  const phrases=['Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡','Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡','Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±','Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡','Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡'];
  let cur=localStorage.getItem('tasbihPhrase')||phrases[0];
  const btns=phrases.map(p=>`<button class="tbb${p===cur?' on':''}" onclick="setPhrase('${safeAttr(p)}',this)">${esc(p)}</button>`).join('');
  vBody.innerHTML=`<div style="text-align:center;padding:22px 14px">
    <div class="tab-bar" style="justify-content:center;flex-wrap:wrap">${btns}</div>
    <div id="tp" style="font-size:1.2em;color:var(--accent);margin:12px 0">${esc(cur)}</div>
    <div id="sc" style="font-size:7em;color:var(--accent);font-weight:bold;line-height:1">${toAr(sCount)}</div>
    <div id="scsub" style="color:gray;margin:6px 0">${toAr(Math.floor(sCount/33))} Ã— Ù£Ù£</div>
    <div class="sebha-circle" onclick="incTas()">Ø³Ø¨Ù‘Ø­</div>
    <button class="btn-back" style="margin-top:22px" onclick="sCount=0;localStorage.setItem('tasbihCount','0');G('sc').textContent='Ù ';G('scsub').textContent='Ù  Ã— Ù£Ù£'">ØªØµÙÙŠØ±</button>
  </div>`;
}
function setPhrase(p,btn){ck();localStorage.setItem('tasbihPhrase',p);G('tp').textContent=p;document.querySelectorAll('.tbb').forEach(b=>b.classList.remove('on'));btn.classList.add('on');}
function incTas(){
  sCount++;ck();if(navigator.vibrate)navigator.vibrate(25);
  G('sc').textContent=toAr(sCount);G('scsub').textContent=toAr(Math.floor(sCount/33))+' Ã— Ù£Ù£';
  localStorage.setItem('tasbihCount',sCount);
  if(sCount%33===0){sh('ğŸŒŸ Ø£Ø­Ø³Ù†Øª!');ckOk();if(navigator.vibrate)navigator.vibrate([80,40,80]);}
}

/* ============================================================
   PRAYER TIMES
============================================================ */
async function renderPrayers(){
  vTitle.textContent='Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©';
  if(!prayerTimes)await loadPrayers();
  const pNames={Fajr:'Ø§Ù„ÙØ¬Ø± ğŸŒ…',Dhuhr:'Ø§Ù„Ø¸Ù‡Ø± â˜€ï¸',Asr:'Ø§Ù„Ø¹ØµØ± ğŸŒ¤ï¸',Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨ ğŸŒ‡',Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡ ğŸŒ™'};
  let html=`<div id="next-card"><h3>â³ Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3><div id="next-name">...</div><div id="next-timer">--:--:--</div></div>`;
  for(const[k,n]of Object.entries(pNames)){
    const t=prayerTimes&&prayerTimes[k]?toAr(prayerTimes[k]):'--:--';
    html+=`<div class="p-row" id="row-${k}"><span class="pn">${n}</span><span class="pt">${t}</span></div>`;
  }
  html+=`<div style="padding:14px;display:flex;gap:10px"><button class="btn-back" style="flex:1" onclick="ck();schedNotifs()">ğŸ”” Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª</button></div>`;
  vBody.innerHTML=html;startCountdown();
}

/* ============================================================
   AZKAR
============================================================ */
function renderAzkar(){
  vTitle.textContent='Ø­ØµÙ† Ø§Ù„Ù…Ø³Ù„Ù… ğŸ“¿';
  const az=[
    {t:'Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­ ğŸŒ…',d:'Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ØŒ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡ØŒ Ù„Ù‡ Ø§Ù„Ù…Ù„Ùƒ ÙˆÙ„Ù‡ Ø§Ù„Ø­Ù…Ø¯ ÙˆÙ‡Ùˆ Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ Ù‚Ø¯ÙŠØ±.',r:3},
    {t:'Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡ ğŸŒ™',d:'Ø£Ù…Ø³ÙŠÙ†Ø§ ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ØŒ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ ÙˆØ­Ø¯Ù‡ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡ØŒ Ù„Ù‡ Ø§Ù„Ù…Ù„Ùƒ ÙˆÙ„Ù‡ Ø§Ù„Ø­Ù…Ø¯ ÙˆÙ‡Ùˆ Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ Ù‚Ø¯ÙŠØ±.',r:3},
    {t:'Ø³ÙŠØ¯ Ø§Ù„Ø§Ø³ØªØºÙØ§Ø± ğŸ¤²',d:'Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø±Ø¨ÙŠ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø£Ù†ØªØŒ Ø®Ù„Ù‚ØªÙ†ÙŠ ÙˆØ£Ù†Ø§ Ø¹Ø¨Ø¯ÙƒØŒ ÙˆØ£Ù†Ø§ Ø¹Ù„Ù‰ Ø¹Ù‡Ø¯Ùƒ ÙˆÙˆØ¹Ø¯Ùƒ Ù…Ø§ Ø§Ø³ØªØ·Ø¹ØªØŒ Ø£Ø¹ÙˆØ° Ø¨Ùƒ Ù…Ù† Ø´Ø± Ù…Ø§ ØµÙ†Ø¹ØªØŒ Ø£Ø¨ÙˆØ¡ Ù„Ùƒ Ø¨Ù†Ø¹Ù…ØªÙƒ Ø¹Ù„ÙŠÙ‘ ÙˆØ£Ø¨ÙˆØ¡ Ø¨Ø°Ù†Ø¨ÙŠ ÙØ§ØºÙØ± Ù„ÙŠØŒ ÙØ¥Ù†Ù‡ Ù„Ø§ ÙŠØºÙØ± Ø§Ù„Ø°Ù†ÙˆØ¨ Ø¥Ù„Ø§ Ø£Ù†Øª.',r:1},
    {t:'Ø¯Ø¹Ø§Ø¡ Ø§Ù„Ù†ÙˆÙ… ğŸ˜´',d:'Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ ÙˆØ¨Ùƒ Ø£Ø±ÙØ¹Ù‡ØŒ ÙØ¥Ù† Ø£Ù…Ø³ÙƒØª Ù†ÙØ³ÙŠ ÙØ§Ø±Ø­Ù…Ù‡Ø§ØŒ ÙˆØ¥Ù† Ø£Ø±Ø³Ù„ØªÙ‡Ø§ ÙØ§Ø­ÙØ¸Ù‡Ø§ Ø¨Ù…Ø§ ØªØ­ÙØ¸ Ø¨Ù‡ Ø¹Ø¨Ø§Ø¯Ùƒ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†.',r:1},
    {t:'Ø¨Ø¹Ø¯ Ø§Ù„ØµÙ„Ø§Ø© ğŸ•Œ',d:'Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡. Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡. Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡. Ø§Ù„Ù„Ù‡Ù… Ø£Ù†Øª Ø§Ù„Ø³Ù„Ø§Ù… ÙˆÙ…Ù†Ùƒ Ø§Ù„Ø³Ù„Ø§Ù…ØŒ ØªØ¨Ø§Ø±ÙƒØª ÙŠØ§ Ø°Ø§ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¥ÙƒØ±Ø§Ù….',r:3},
    {t:'Ø§Ù„ØªØ³Ø¨ÙŠØ­ âœ¨',d:'Ø³ÙØ¨Ù’Ø­ÙØ§Ù†Ù Ø§Ù„Ù„ÙÙ‘Ù‡Ù ÙˆÙØ¨ÙØ­ÙÙ…Ù’Ø¯ÙÙ‡Ù.',r:100},
    {t:'Ø§Ù„ØµÙ„Ø§Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ï·º',d:'Ø§Ù„Ù„ÙÙ‘Ù‡ÙÙ…ÙÙ‘ ØµÙÙ„ÙÙ‘ ÙˆÙØ³ÙÙ„ÙÙ‘Ù…Ù’ Ø¹ÙÙ„ÙÙ‰ Ù†ÙØ¨ÙÙŠÙÙ‘Ù†ÙØ§ Ù…ÙØ­ÙÙ…ÙÙ‘Ø¯Ù.',r:10},
    {t:'Ø¢ÙŠØ© Ø§Ù„ÙƒØ±Ø³ÙŠ ğŸ›¡ï¸',d:'Ø§Ù„Ù„ÙÙ‘Ù‡Ù Ù„ÙØ§ Ø¥ÙÙ„ÙÙ‡Ù Ø¥ÙÙ„ÙÙ‘Ø§ Ù‡ÙÙˆÙ Ø§Ù„Ù’Ø­ÙÙŠÙÙ‘ Ø§Ù„Ù’Ù‚ÙÙŠÙÙ‘ÙˆÙ…Ù Ûš Ù„ÙØ§ ØªÙØ£Ù’Ø®ÙØ°ÙÙ‡Ù Ø³ÙÙ†ÙØ©ÙŒ ÙˆÙÙ„ÙØ§ Ù†ÙÙˆÙ’Ù…ÙŒ.',r:1},
    {t:'Ø¯Ø¹Ø§Ø¡ Ø§Ù„ÙƒØ±Ø¨ ğŸ’™',d:'Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ… Ø§Ù„Ø­Ù„ÙŠÙ…ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ Ø±Ø¨ Ø§Ù„Ø¹Ø±Ø´ Ø§Ù„Ø¹Ø¸ÙŠÙ…ØŒ Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡ Ø±Ø¨ Ø§Ù„Ø³Ù…ÙˆØ§Øª ÙˆØ±Ø¨ Ø§Ù„Ø£Ø±Ø¶ ÙˆØ±Ø¨ Ø§Ù„Ø¹Ø±Ø´ Ø§Ù„ÙƒØ±ÙŠÙ….',r:3},
    {t:'Ø§Ù„Ø­ØµÙ† Ù…Ù† Ø§Ù„Ø´ÙŠØ·Ø§Ù† ğŸ”’',d:'Ø£Ø¹ÙˆØ° Ø¨ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù„Ù‡ Ø§Ù„ØªØ§Ù…Ø§Øª Ù…Ù† Ø´Ø± Ù…Ø§ Ø®Ù„Ù‚.',r:3}
  ];
  vBody.innerHTML=az.map(a=>`<div class="ayah-frame"><h3 style="color:var(--accent);margin-bottom:10px">${esc(a.t)}</h3><div class="qf" style="font-size:1.22em">${esc(a.d)}</div><div style="color:gray;font-size:.82em;margin-top:8px">Ø§Ù„ØªÙƒØ±Ø§Ø±: ${toAr(a.r)} Ù…Ø±Ø©</div><div style="margin-top:9px"><button class="ab" onclick="cpAyah('${esc(a.d).replace(/'/g,"\\'")}')">Ù†Ø³Ø®</button></div></div>`).join('');
}

/* ============================================================
   NAMES
============================================================ */
function renderNames(){
  vTitle.textContent='Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­Ø³Ù†Ù‰ âœ¨';
  const nd=[
    {n:'Ø§Ù„Ø±Ø­Ù…Ù†',m:'Ø§Ù„Ø°ÙŠ ÙˆØ³Ø¹Øª Ø±Ø­Ù…ØªÙ‡ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø±Ø­ÙŠÙ…',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±Ø­Ù… Ø¹Ø¨Ø§Ø¯Ù‡ Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†'},{n:'Ø§Ù„Ù…Ù„Ùƒ',m:'Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ù„Ùƒ ÙƒÙ„Ù‡'},{n:'Ø§Ù„Ù‚Ø¯ÙˆØ³',m:'Ø§Ù„Ù…Ù†Ø²Ù‘Ù‡ Ø¹Ù† ÙƒÙ„ Ù†Ù‚Øµ'},{n:'Ø§Ù„Ø³Ù„Ø§Ù…',m:'Ø§Ù„Ø°ÙŠ Ø³Ù„Ù… Ù…Ù† ÙƒÙ„ Ø¹ÙŠØ¨'},{n:'Ø§Ù„Ù…Ø¤Ù…Ù†',m:'Ø§Ù„Ø°ÙŠ Ø£Ù…Ù‘Ù† Ø¹Ø¨Ø§Ø¯Ù‡ Ù…Ù† Ø¹Ø°Ø§Ø¨Ù‡'},{n:'Ø§Ù„Ù…Ù‡ÙŠÙ…Ù†',m:'Ø§Ù„Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø±Ù‚ÙŠØ¨ Ø¹Ù„Ù‰ Ø®Ù„Ù‚Ù‡'},{n:'Ø§Ù„Ø¹Ø²ÙŠØ²',m:'Ø§Ù„ØºØ§Ù„Ø¨ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙØºÙ„Ø¨'},{n:'Ø§Ù„Ø¬Ø¨Ø§Ø±',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨Ø± Ø§Ù„ÙƒØ³ÙŠØ± ÙˆÙŠÙ‚Ù‡Ø± Ø§Ù„Ø¹ØµØ§Ø©'},{n:'Ø§Ù„Ù…ØªÙƒØ¨Ø±',m:'Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ Ø¹Ù† ØµÙØ§Øª Ø§Ù„Ù†Ù‚Øµ'},{n:'Ø§Ù„Ø®Ø§Ù„Ù‚',m:'Ø§Ù„Ù…ÙˆØ¬Ø¯ Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ù…Ù† Ø§Ù„Ø¹Ø¯Ù…'},{n:'Ø§Ù„Ø¨Ø§Ø±Ø¦',m:'Ø§Ù„Ø®Ø§Ù„Ù‚ Ø¹Ù„Ù‰ ØºÙŠØ± Ù…Ø«Ø§Ù„ Ø³Ø§Ø¨Ù‚'},{n:'Ø§Ù„Ù…ØµÙˆØ±',m:'Ø§Ù„Ø°ÙŠ ÙŠØµÙˆØ± Ø§Ù„Ø®Ù„Ù‚ ÙƒÙŠÙ ÙŠØ´Ø§Ø¡'},{n:'Ø§Ù„ØºÙØ§Ø±',m:'Ø§Ù„Ø°ÙŠ ÙŠØºÙØ± Ø§Ù„Ø°Ù†ÙˆØ¨ Ù…Ø±Ø§Ø±Ø§Ù‹'},{n:'Ø§Ù„Ù‚Ù‡Ø§Ø±',m:'Ø§Ù„ØºØ§Ù„Ø¨ Ø§Ù„Ø°ÙŠ Ù‚Ù‡Ø± ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„ÙˆÙ‡Ø§Ø¨',m:'Ø§Ù„ÙƒØ«ÙŠØ± Ø§Ù„Ø¹Ø·Ø§Ø¡ Ø¨Ù„Ø§ Ù…Ù‚Ø§Ø¨Ù„'},{n:'Ø§Ù„Ø±Ø²Ø§Ù‚',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±Ø²Ù‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ù„Ù‚'},{n:'Ø§Ù„ÙØªØ§Ø­',m:'Ø§Ù„Ø°ÙŠ ÙŠÙØªØ­ Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ø±Ø­Ù…Ø© ÙˆØ§Ù„Ø®ÙŠØ±'},{n:'Ø§Ù„Ø¹Ù„ÙŠÙ…',m:'Ø§Ù„Ø°ÙŠ Ø£Ø­Ø§Ø· Ø¹Ù„Ù…Ù‡ Ø¨ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ù‚Ø§Ø¨Ø¶',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ‚Ø¨Ø¶ Ø§Ù„Ø£Ø±Ø²Ø§Ù‚ Ø¨Ø­ÙƒÙ…Ø©'},{n:'Ø§Ù„Ø¨Ø§Ø³Ø·',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¨Ø³Ø· Ø§Ù„Ø±Ø²Ù‚ Ù„Ù…Ù† ÙŠØ´Ø§Ø¡'},{n:'Ø§Ù„Ø®Ø§ÙØ¶',m:'Ø§Ù„Ø°ÙŠ ÙŠØ®ÙØ¶ Ø§Ù„Ø¬Ø¨Ø§Ø±ÙŠÙ†'},{n:'Ø§Ù„Ø±Ø§ÙØ¹',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±ÙØ¹ Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†'},{n:'Ø§Ù„Ù…Ø¹Ø²',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¹Ø² Ù…Ù† ÙŠØ´Ø§Ø¡'},{n:'Ø§Ù„Ù…Ø°Ù„',m:'Ø§Ù„Ø°ÙŠ ÙŠØ°Ù„ Ù…Ù† ÙŠØ´Ø§Ø¡'},{n:'Ø§Ù„Ø³Ù…ÙŠØ¹',m:'Ø§Ù„Ø°ÙŠ ÙŠØ³Ù…Ø¹ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø¨ØµÙŠØ±',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±Ù‰ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø­ÙƒÙ…',m:'Ø§Ù„Ø°ÙŠ ÙŠØ­ÙƒÙ… Ø¨ÙŠÙ† Ø§Ù„Ø®Ù„Ù‚ Ø¨Ø¹Ø¯Ù„'},{n:'Ø§Ù„Ø¹Ø¯Ù„',m:'Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¸Ù„Ù… Ø£Ø­Ø¯Ø§Ù‹'},{n:'Ø§Ù„Ù„Ø·ÙŠÙ',m:'Ø§Ù„Ø¹Ù„ÙŠÙ… Ø¨Ø¯Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø£Ù…ÙˆØ±'},{n:'Ø§Ù„Ø®Ø¨ÙŠØ±',m:'Ø§Ù„Ù…Ø·Ù„Ø¹ Ø¹Ù„Ù‰ Ø­Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ø¨Ø§Ø·Ù†Ø©'},{n:'Ø§Ù„Ø­Ù„ÙŠÙ…',m:'Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¹Ø¬Ù„ Ø¨Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø©'},{n:'Ø§Ù„Ø¹Ø¸ÙŠÙ…',m:'Ø§Ù„Ø¬Ø§Ù…Ø¹ Ù„ØµÙØ§Øª Ø§Ù„Ø¹Ø¸Ù…Ø©'},{n:'Ø§Ù„ØºÙÙˆØ±',m:'Ø§Ù„Ø°ÙŠ ÙŠØºÙØ± Ø§Ù„Ø°Ù†ÙˆØ¨ Ø¬Ù…ÙŠØ¹Ù‡Ø§'},{n:'Ø§Ù„Ø´ÙƒÙˆØ±',m:'Ø§Ù„Ø°ÙŠ ÙŠØ´ÙƒØ± Ø§Ù„Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„'},{n:'Ø§Ù„Ø¹Ù„ÙŠ',m:'Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ ÙÙˆÙ‚ Ø®Ù„Ù‚Ù‡'},{n:'Ø§Ù„ÙƒØ¨ÙŠØ±',m:'Ø§Ù„ÙƒØ¨ÙŠØ± Ø§Ù„Ø°ÙŠ ÙƒÙ„ Ø´ÙŠØ¡ Ø¯ÙˆÙ†Ù‡'},{n:'Ø§Ù„Ø­ÙÙŠØ¸',m:'Ø§Ù„Ø°ÙŠ ÙŠØ­ÙØ¸ Ø®Ù„Ù‚Ù‡'},{n:'Ø§Ù„Ù…Ù‚ÙŠØª',m:'Ø§Ù„Ø±Ø§Ø²Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ ÙƒÙ„ Ù†ÙØ³'},{n:'Ø§Ù„Ø­Ø³ÙŠØ¨',m:'Ø§Ù„ÙƒØ§ÙÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­Ø§Ø³Ø¨ Ø§Ù„Ø¹Ø¨Ø§Ø¯'},{n:'Ø§Ù„Ø¬Ù„ÙŠÙ„',m:'Ø°Ùˆ Ø§Ù„Ø¬Ù„Ø§Ù„ ÙˆØ§Ù„Ø¹Ø¸Ù…Ø©'},{n:'Ø§Ù„ÙƒØ±ÙŠÙ…',m:'Ø§Ù„Ø¬ÙˆØ§Ø¯ Ø§Ù„ÙƒØ«ÙŠØ± Ø§Ù„Ø®ÙŠØ±'},{n:'Ø§Ù„Ø±Ù‚ÙŠØ¨',m:'Ø§Ù„Ø´Ø§Ù‡Ø¯ Ø§Ù„Ø­ÙÙŠØ¸ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØºÙÙ„'},{n:'Ø§Ù„Ù…Ø¬ÙŠØ¨',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¬ÙŠØ¨ Ø¯Ø¹Ø§Ø¡ Ù…Ù† Ø¯Ø¹Ø§Ù‡'},{n:'Ø§Ù„ÙˆØ§Ø³Ø¹',m:'Ø§Ù„Ø°ÙŠ ÙˆØ³Ø¹ Ø¹Ù„Ù…Ù‡ ÙˆÙØ¶Ù„Ù‡ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø­ÙƒÙŠÙ…',m:'Ø°Ùˆ Ø§Ù„Ø­ÙƒÙ…Ø© Ø§Ù„ØªØ§Ù…Ø© ÙÙŠ Ø£ÙØ¹Ø§Ù„Ù‡'},{n:'Ø§Ù„ÙˆØ¯ÙˆØ¯',m:'Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¨ Ø¹Ø¨Ø§Ø¯Ù‡ Ø§Ù„ØµØ§Ù„Ø­ÙŠÙ†'},{n:'Ø§Ù„Ù…Ø¬ÙŠØ¯',m:'Ø§Ù„Ø±ÙÙŠØ¹ Ø´Ø£Ù†Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ… Ù‚Ø¯Ø±Ù‡'},{n:'Ø§Ù„Ø¨Ø§Ø¹Ø«',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¨Ø¹Ø« Ø§Ù„Ù…ÙˆØªÙ‰ ÙŠÙˆÙ… Ø§Ù„Ù‚ÙŠØ§Ù…Ø©'},{n:'Ø§Ù„Ø´Ù‡ÙŠØ¯',m:'Ø§Ù„Ø­Ø§Ø¶Ø± Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØºÙŠØ¨ Ø¹Ù† Ø¹Ù„Ù…Ù‡ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø­Ù‚',m:'Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø­Ù‚Ø§Ù‹ Ø§Ù„Ø«Ø§Ø¨Øª Ø£Ø¨Ø¯Ø§Ù‹'},{n:'Ø§Ù„ÙˆÙƒÙŠÙ„',m:'Ø§Ù„ÙƒØ§ÙÙŠ Ù„Ù…Ù† ØªÙˆÙƒÙ„ Ø¹Ù„ÙŠÙ‡'},{n:'Ø§Ù„Ù‚ÙˆÙŠ',m:'Ø§Ù„ØªØ§Ù… Ø§Ù„Ù‚ÙˆØ© Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙØ¹Ø¬Ø²Ù‡ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ù…ØªÙŠÙ†',m:'Ø§Ù„Ø´Ø¯ÙŠØ¯ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø¨Ø·Ø´'},{n:'Ø§Ù„ÙˆÙ„ÙŠ',m:'Ø§Ù„Ù†Ø§ØµØ± Ù„Ø¹Ø¨Ø§Ø¯Ù‡ Ø§Ù„Ù…Ø¤Ù…Ù†ÙŠÙ†'},{n:'Ø§Ù„Ø­Ù…ÙŠØ¯',m:'Ø§Ù„Ù…Ø­Ù…ÙˆØ¯ Ø¨ÙƒÙ„ Ù„Ø³Ø§Ù†'},{n:'Ø§Ù„Ù…Ø­ØµÙŠ',m:'Ø§Ù„Ø°ÙŠ Ø£Ø­ØµÙ‰ ÙƒÙ„ Ø´ÙŠØ¡ Ø¹Ø¯Ø¯Ø§Ù‹'},{n:'Ø§Ù„Ù…Ø¨Ø¯Ø¦',m:'Ø§Ù„Ø°ÙŠ Ø¨Ø¯Ø£ Ø§Ù„Ø®Ù„Ù‚ Ù…Ù† Ø§Ù„Ø¹Ø¯Ù…'},{n:'Ø§Ù„Ù…Ø¹ÙŠØ¯',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¹ÙŠØ¯ Ø§Ù„Ø®Ù„Ù‚ Ø¨Ø¹Ø¯ Ø§Ù„ÙÙ†Ø§Ø¡'},{n:'Ø§Ù„Ù…Ø­ÙŠÙŠ',m:'Ø§Ù„Ø°ÙŠ ÙŠØ­ÙŠÙŠ Ø§Ù„Ù…ÙˆØªÙ‰'},{n:'Ø§Ù„Ù…Ù…ÙŠØª',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ…ÙŠØª Ø§Ù„Ø£Ø­ÙŠØ§Ø¡'},{n:'Ø§Ù„Ø­ÙŠ',m:'Ø§Ù„Ø¯Ø§Ø¦Ù… Ø§Ù„Ø­ÙŠØ§Ø© Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙ…ÙˆØª'},{n:'Ø§Ù„Ù‚ÙŠÙˆÙ…',m:'Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¨Ù†ÙØ³Ù‡ Ø§Ù„Ù…ÙÙ‚ÙŠÙ… Ù„ØºÙŠØ±Ù‡'},{n:'Ø§Ù„ÙˆØ§Ø¬Ø¯',m:'Ø§Ù„ØºÙ†ÙŠ Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙØªÙ‚Ø± Ù„Ø´ÙŠØ¡'},{n:'Ø§Ù„Ù…Ø§Ø¬Ø¯',m:'Ø§Ù„Ø´Ø±ÙŠÙ Ø°Ùˆ Ø§Ù„Ù…Ø¬Ø¯ ÙˆØ§Ù„ÙƒØ±Ù…'},{n:'Ø§Ù„ÙˆØ§Ø­Ø¯',m:'Ø§Ù„Ù…Ù†ÙØ±Ø¯ Ø¨Ø°Ø§ØªÙ‡ ÙˆØµÙØ§ØªÙ‡'},{n:'Ø§Ù„Ø£Ø­Ø¯',m:'Ø§Ù„ÙØ±Ø¯ Ø§Ù„Ø°ÙŠ Ù„Ø§ Ø´Ø±ÙŠÙƒ Ù„Ù‡'},{n:'Ø§Ù„ØµÙ…Ø¯',m:'Ø§Ù„Ø°ÙŠ ÙŠÙÙ‚ØµØ¯ ÙÙŠ Ø§Ù„Ø­ÙˆØ§Ø¦Ø¬ ÙƒÙ„Ù‡Ø§'},{n:'Ø§Ù„Ù‚Ø§Ø¯Ø±',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ‚Ø¯Ø± Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ù…Ù‚ØªØ¯Ø±',m:'Ø§Ù„Ø´Ø¯ÙŠØ¯ Ø§Ù„Ù‚Ø¯Ø±Ø©'},{n:'Ø§Ù„Ù…Ù‚Ø¯Ù…',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ‚Ø¯Ù… Ù…Ø§ Ø´Ø§Ø¡'},{n:'Ø§Ù„Ù…Ø¤Ø®Ø±',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¤Ø®Ø± Ù…Ø§ Ø´Ø§Ø¡ Ø¨Ø­ÙƒÙ…Ø©'},{n:'Ø§Ù„Ø£ÙˆÙ„',m:'Ø§Ù„Ø°ÙŠ Ù„ÙŠØ³ Ù‚Ø¨Ù„Ù‡ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø¢Ø®Ø±',m:'Ø§Ù„Ø°ÙŠ Ù„ÙŠØ³ Ø¨Ø¹Ø¯Ù‡ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ø¸Ø§Ù‡Ø±',m:'Ø§Ù„Ø°ÙŠ Ø¸Ù‡Ø± ÙÙˆÙ‚ ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ù‚Ø¯Ø±ØªÙ‡'},{n:'Ø§Ù„Ø¨Ø§Ø·Ù†',m:'Ø§Ù„Ø¹Ø§Ù„Ù… Ø¨ÙƒÙ„ Ø®ÙÙŠØ© ÙˆØ³Ø±'},{n:'Ø§Ù„ÙˆØ§Ù„ÙŠ',m:'Ø§Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…ØªØµØ±Ù ÙÙŠ ÙƒÙ„ Ø´ÙŠØ¡'},{n:'Ø§Ù„Ù…ØªØ¹Ø§Ù„ÙŠ',m:'Ø§Ù„Ø¹Ø§Ù„ÙŠ Ø¹Ù„Ù‰ ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø¹Ø¸Ù…ØªÙ‡'},{n:'Ø§Ù„Ø¨Ø±',m:'Ø§Ù„Ø¹Ø·ÙˆÙ Ø¹Ù„Ù‰ Ø¹Ø¨Ø§Ø¯Ù‡ Ø§Ù„Ø±Ø­ÙŠÙ… Ø¨Ù‡Ù…'},{n:'Ø§Ù„ØªÙˆØ§Ø¨',m:'Ø§Ù„Ø°ÙŠ ÙŠÙƒØ«Ø± Ù‚Ø¨ÙˆÙ„ ØªÙˆØ¨Ø© Ø¹Ø¨Ø§Ø¯Ù‡'},{n:'Ø§Ù„Ù…Ù†ØªÙ‚Ù…',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ†ØªÙ‚Ù… Ù…Ù† Ø§Ù„Ø¸Ø§Ù„Ù…ÙŠÙ†'},{n:'Ø§Ù„Ø¹ÙÙˆ',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø­Ùˆ Ø§Ù„Ø°Ù†ÙˆØ¨ ÙˆÙŠØµÙØ­'},{n:'Ø§Ù„Ø±Ø¤ÙˆÙ',m:'Ø§Ù„Ø±Ù‚ÙŠÙ‚ Ø§Ù„Ø¹Ø·ÙˆÙ Ø¹Ù„Ù‰ Ø¹Ø¨Ø§Ø¯Ù‡'},{n:'Ù…Ø§Ù„Ùƒ Ø§Ù„Ù…Ù„Ùƒ',m:'Ù…Ø§Ù„Ùƒ Ø§Ù„Ø¯Ù†ÙŠØ§ ÙˆØ§Ù„Ø¢Ø®Ø±Ø©'},{n:'Ø°Ùˆ Ø§Ù„Ø¬Ù„Ø§Ù„',m:'ØµØ§Ø­Ø¨ Ø§Ù„Ø¹Ø¸Ù…Ø© ÙˆØ§Ù„ÙƒØ±Ù… Ø§Ù„ØªØ§Ù…'},{n:'Ø§Ù„Ù…Ù‚Ø³Ø·',m:'Ø§Ù„Ø¹Ø§Ø¯Ù„ ÙÙŠ Ø­ÙƒÙ…Ù‡ ÙˆÙ‚Ø¶Ø§Ø¦Ù‡'},{n:'Ø§Ù„Ø¬Ø§Ù…Ø¹',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¬Ù…Ø¹ Ø§Ù„Ø®Ù„Ù‚ Ù„Ù„Ø­Ø³Ø§Ø¨'},{n:'Ø§Ù„ØºÙ†ÙŠ',m:'Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ­ØªØ§Ø¬ Ù„Ø£Ø­Ø¯'},{n:'Ø§Ù„Ù…ØºÙ†ÙŠ',m:'Ø§Ù„Ø°ÙŠ ÙŠØºÙ†ÙŠ Ù…Ù† ÙŠØ´Ø§Ø¡ Ù…Ù† Ø¹Ø¨Ø§Ø¯Ù‡'},{n:'Ø§Ù„Ù…Ø§Ù†Ø¹',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ…Ù†Ø¹ Ù…Ø§ ÙŠØ´Ø§Ø¡ Ø¨Ø­ÙƒÙ…ØªÙ‡'},{n:'Ø§Ù„Ø¶Ø§Ø±',m:'Ø§Ù„Ø°ÙŠ ÙŠØ¶Ø± Ù…Ù† ÙŠØ´Ø§Ø¡ Ø¹Ø¯Ù„Ø§Ù‹'},{n:'Ø§Ù„Ù†Ø§ÙØ¹',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ†ÙØ¹ Ù…Ù† ÙŠØ´Ø§Ø¡ ÙØ¶Ù„Ø§Ù‹'},{n:'Ø§Ù„Ù†ÙˆØ±',m:'Ø§Ù„Ø°ÙŠ Ù†ÙˆÙ‘Ø± Ø§Ù„Ø³Ù…Ø§ÙˆØ§Øª ÙˆØ§Ù„Ø£Ø±Ø¶'},{n:'Ø§Ù„Ù‡Ø§Ø¯ÙŠ',m:'Ø§Ù„Ø°ÙŠ ÙŠÙ‡Ø¯ÙŠ Ù…Ù† ÙŠØ´Ø§Ø¡ Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø­Ù‚'},{n:'Ø§Ù„Ø¨Ø¯ÙŠØ¹',m:'Ø§Ù„Ù…Ø¨ØªÙƒØ± Ù„Ù„Ø£Ø´ÙŠØ§Ø¡ Ø¨Ù„Ø§ Ù…Ø«Ø§Ù„'},{n:'Ø§Ù„Ø¨Ø§Ù‚ÙŠ',m:'Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠÙÙ†Ù‰ ÙˆÙ„Ø§ ÙŠØ²ÙˆÙ„'},{n:'Ø§Ù„ÙˆØ§Ø±Ø«',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±Ø« Ø§Ù„Ø£Ø±Ø¶ ÙˆÙ…Ù† Ø¹Ù„ÙŠÙ‡Ø§'},{n:'Ø§Ù„Ø±Ø´ÙŠØ¯',m:'Ø§Ù„Ø°ÙŠ ÙŠØ±Ø´Ø¯ Ø¥Ù„Ù‰ Ø§Ù„ØµÙˆØ§Ø¨'},{n:'Ø§Ù„ØµØ¨ÙˆØ±',m:'Ø§Ù„Ø°ÙŠ Ù„Ø§ ÙŠØ¹Ø¬Ù„ Ø¹Ù„Ù‰ Ù…Ù† Ø¹ØµØ§Ù‡'}
  ];
  let html='<div class="grid" style="margin-top:14px">';
  nd.forEach((it,i)=>{html+=`<div class="name-card" onclick="ck();sh('${esc(it.n)}: ${esc(it.m)}')"><div style="color:var(--accent);font-size:.76em">${toAr(i+1)}</div><b style="font-size:1.08em">${esc(it.n)}</b></div>`;});
  vBody.innerHTML=html+'</div>';
}

/* ============================================================
   KHATMA
============================================================ */
function renderKhatma(){
  vTitle.textContent='Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© ğŸŒŸ';
  vBody.innerHTML=`<div style="text-align:center;padding:40px 20px">
    <div style="font-size:1.1em;color:var(--text);margin-bottom:8px">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ø³Ù„Ù…ÙŠÙ† Ø­ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…</div>
    <div id="gc" style="font-size:5.5em;color:var(--accent);font-weight:bold">...</div>
    <p style="color:gray;margin-bottom:28px">Ø³ÙˆØ±Ø© ØªÙ… Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ø¬Ù…Ø§Ø¹ÙŠØ§Ù‹</p>
    <div class="sebha-circle" style="background:var(--accent);color:var(--primary);font-size:1.3em" onclick="incKhatma()">Ø£Ù†Ù‡ÙŠØª Ø³ÙˆØ±Ø©</div>
    <p style="color:gray;font-size:.87em;margin-top:16px;padding:0 24px">ÙƒÙ„ Ø³ÙˆØ±Ø© ØªÙÙ‚Ø±Ø£ ØªÙØ³Ø¬ÙÙ‘Ù„ ÙÙŠ Ø§Ù„Ø®ØªÙ…Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ù„Ù„Ù…Ø³Ù„Ù…ÙŠÙ†</p>
  </div>`;
  if(window._fb){const{db,ref,onValue}=window._fb;onValue(ref(db,'khatma_global/total'),s=>{const gc=G('gc');if(gc)gc.textContent=toAr(s.val()||0);});}
}
function incKhatma(){
  ck();if(!window._fb){sh('ØªØ­ØªØ§Ø¬ Ø§ØªØµØ§Ù„Ø§Ù‹ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ©');return;}
  const{db,ref,get,set}=window._fb;const r=ref(db,'khatma_global/total');
  get(r).then(s=>{set(r,(s.val()||0)+1);sh('ğŸŒŸ ØªÙ‚Ø¨Ù‘Ù„ Ø§Ù„Ù„Ù‡ Ù…Ù†Ùƒ');ckOk();if(navigator.vibrate)navigator.vibrate([80,40,80]);}).catch(()=>sh('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„'));
}
</script>
</body>
</html>
